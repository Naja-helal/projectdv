# ๐ ุฏููู Deploy ุงูุชุทุจูู

## โ๏ธ ููู ุฌุฏุงู - ุงูุญูุงุธ ุนูู ุงูุจูุงูุงุช

### ุงููุดููุฉ ุงูุณุงุจูุฉ:
- ูุงู ุงูุชุทุจูู ูููุฏ ุฌููุน ุงูุจูุงูุงุช ุนูุฏ ูู deploy ุฌุฏูุฏ
- ุงูุณุจุจ: ูุงุนุฏุฉ ุงูุจูุงูุงุช SQLite ูุงูุช ูู ูุฌูุฏ ุงููุดุฑูุน ููุณู

### โ ุงูุญู (ุชู ุชุทุจููู):
ุงุณุชุฎุฏุงู **Railway Volume** ูุญูุธ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฎุงุฑุฌ ูุฌูุฏ ุงููุดุฑูุน

---

## ๐ ุฎุทูุงุช Deploy ุนูู Railway

### 1๏ธโฃ ุฅุนุฏุงุฏ Volume ูู Railway (ูุฑุฉ ูุงุญุฏุฉ ููุท):

```bash
# ูู ููุญุฉ ุชุญูู Railway:
1. ุงูุชุญ ูุดุฑูุนู
2. ุงุฐูุจ ุฅูู Settings โ Volumes
3. ุงุถุบุท New Volume
4. ุงุณู ุงูู Volume: expenses_data
5. Mount Path: /app/data
6. ุงุญูุธ ุงูุชุบููุฑุงุช
```

### 2๏ธโฃ Deploy ุงูุชุนุฏููุงุช ุงูุฌุฏูุฏุฉ:

```bash
# ูู ูุฌูุฏ ุงููุดุฑูุน ุงูุฑุฆูุณู
cd "c:\Users\naja2\Desktop\Tkamol2025\saud - Copy (4)"

# ุชุฃูุฏ ูู ุฃู ุงูุชุนุฏููุงุช ูุญููุธุฉ
git status

# ุฅุถุงูุฉ ุฌููุน ุงููููุงุช
git add .

# ุนูู commit ูุน ุฑุณุงูุฉ ูุงุถุญุฉ
git commit -m "feat: ูุธุงู ุฅุฏุงุฑุฉ ุงูุนููุงุก + ุฅุฒุงูุฉ ููุน ุงููุดุฑูุน + ุญูุธ ุงูุจูุงูุงุช"

# ุฏูุน ุงูุชุนุฏููุงุช
git push origin main
```

### 3๏ธโฃ Railway ุณูุนูู Deploy ุชููุงุฆูุงู:
- ุณูุชู ุจูุงุก ุงููุดุฑูุน ูู ุฌุฏูุฏ
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุณุชุจูู ูุญููุธุฉ ูู `/app/data/`
- โ ุงูุจูุงูุงุช ุงููุฏููุฉ ูู ุชูุญุฐู
- โ ุงูุชุญุฏูุซุงุช ุนูู ุงููุงุนุฏุฉ ุณุชูุทุจู ุชููุงุฆูุงู

---

## ๐ง ุงูุชุนุฏููุงุช ุงููุทุจูุฉ ููุญูุงุธ ุนูู ุงูุจูุงูุงุช:

### 1. `server/railway.json`:
```json
{
  "deploy": {
    "volumeMounts": [
      {
        "mountPath": "/app/data",
        "volumeName": "expenses_data"
      }
    ]
  }
}
```

### 2. `server/src/index.ts`:
```typescript
// ูู ุจูุฆุฉ ุงูุฅูุชุงุฌุ ุงุณุชุฎุฏุงู ุงููุณุงุฑ ุงูุซุงุจุช ูู Volume
const dbPath = isProduction 
  ? '/app/data/expenses.db'  // ูุญููุธ ูู Volume
  : './expenses.db';         // ูุญูู ููุชุทููุฑ
```

---

## ๐ ููู ุชุนูู ุงูุชุญุฏูุซุงุช ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ

### ุนูุฏ ูู deploy ุฌุฏูุฏ:
1. **ุงูุชุญูู ูู ูุฌูุฏ ุงููุงุนุฏุฉ**: 
   - ุฅุฐุง ูุงูุช ููุฌูุฏุฉ ูู `/app/data/` โ ูุณุชุฎุฏููุง
   - ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ โ ููุดุฆ ูุงุนุฏุฉ ุฌุฏูุฏุฉ

2. **ุชุทุจูู ุงูุชุญุฏูุซุงุช ุงูุชููุงุฆูุฉ**:
   ```typescript
   // ุงูููุฏ ูุชุญูู ูู ุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ ููุถูู ุงูุฌุฏูุฏ ููุท
   const columns = db.pragma('table_info(projects)');
   const hasClientId = columns.some(col => col.name === 'client_id');
   
   if (!hasClientId) {
     // ุฅุถุงูุฉ ุงูุนููุฏ ุงูุฌุฏูุฏ ููุท
     db.exec('ALTER TABLE projects ADD COLUMN client_id INTEGER DEFAULT 1');
   }
   ```

3. **ุงููุชูุฌุฉ**:
   - โ ุงูุจูุงูุงุช ุงููุฏููุฉ ูุญููุธุฉ
   - โ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ ุชูุถุงู ุชููุงุฆูุงู
   - โ ูุง ููุฌุฏ ููุฏุงู ููุจูุงูุงุช

---

## ๐ฏ ูุซุงู: ุฅุถุงูุฉ ุนููุฏ ุฌุฏูุฏ ูู ุงููุณุชูุจู

```typescript
// ูู server/src/index.ts - ุจุนุฏ ูุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช

// ุงูุชุญูู ูู ูุฌูุฏ ุงูุนููุฏ ุงูุฌุฏูุฏ
const columns = db.pragma('table_info(table_name)');
const hasNewColumn = columns.some(col => col.name === 'new_column');

if (!hasNewColumn) {
  console.log('โ ุฅุถุงูุฉ ุนููุฏ new_column...');
  db.exec(`
    ALTER TABLE table_name 
    ADD COLUMN new_column TEXT DEFAULT 'default_value'
  `);
  console.log('โ ุชู ุฅุถุงูุฉ ุงูุนููุฏ ุจูุฌุงุญ');
}
```

---

## โก ูุตุงุฆุญ ูููุฉ:

### โ ุงูุนู:
1. **ุฏุงุฆูุงู ุงุณุชุฎุฏู ุงูุชุญูู ูุจู ุงูุชุนุฏูู**:
   ```typescript
   if (!columnExists) {
     // ุฃุถู ุงูุนููุฏ
   }
   ```

2. **ุงุณุชุฎุฏู ALTER TABLE ADD** ููุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ

3. **ุงุณุชุฎุฏู BEGIN TRANSACTION** ููุชุนุฏููุงุช ุงููุจูุฑุฉ:
   ```typescript
   db.exec(`
     BEGIN TRANSACTION;
     -- ุชุนุฏููุงุชู ููุง
     COMMIT;
   `);
   ```

### โ ูุง ุชูุนู:
1. โ ูุง ุชุณุชุฎุฏู `DROP TABLE` ุฅูุง ุจุญุฐุฑ ุดุฏูุฏ
2. โ ูุง ุชุญุฐู ุงูู Volume ูู Railway
3. โ ูุง ุชุบูุฑ `mountPath` ุจุนุฏ ุฅูุดุงุก ุงูู Volume

---

## ๐ ุงูุชุญูู ูู ูุฌุงุญ Deploy:

```bash
# 1. ุชุญูู ูู Logs ูู Railway
# ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:
โ ุชู ูุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช: /app/data/expenses.db
โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ
๐ ุงูุณูุฑูุฑ ูุนูู ุนูู ุงููููุฐ 5175

# 2. ุงุฎุชุจุฑ API
curl https://your-app.railway.app/api/projects
```

---

## ๐ ูู ุญุงู ูุฌูุฏ ูุดุงูู:

1. **ูุง ูููู ุงููุตูู ููุจูุงูุงุช**:
   - ุชุญูู ูู ุฃู ุงูู Volume ุชู ุฅูุดุงุคู ุจุดูู ุตุญูุญ
   - ุชุญูู ูู ุงูู Logs ููู errors

2. **ุงูุจูุงูุงุช ูุง ุฒุงูุช ุชูุญุฐู**:
   - ุชุฃูุฏ ุฃู `mountPath` ูู `/app/data`
   - ุชุฃูุฏ ุฃู ุงูููุฏ ูุณุชุฎุฏู ุงููุณุงุฑ ุงูุตุญูุญ

3. **ุฎุทุฃ ูู ุงูุชุญุฏูุซุงุช**:
   - ุฑุงุฌุน ุงูู migrations ูู `index.ts`
   - ุชุญูู ูู ุงูู logs ููู SQL errors

---

## ๐ ุงูุฎูุงุตุฉ:

ุงูุขู ุนูุฏ ูู deploy:
- โ ุงูุจูุงูุงุช ูุญููุธุฉ ูู Railway Volume
- โ ุงูุชุญุฏูุซุงุช ุชูุทุจู ุชููุงุฆูุงู
- โ ูุง ููุฌุฏ ููุฏุงู ููุจูุงูุงุช
- โ ููููู ุนูู deploy ุจุฏูู ููู!

---

**ุขุฎุฑ ุชุญุฏูุซ**: 29 ููููุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ**: 2.0 (ูุน ูุธุงู ุฅุฏุงุฑุฉ ุงูุนููุงุก)
